extern "C" __mlu_global__ void softmax_kernel0(float* A, float* output){
  __nram__ float dest[192];
  __nram__ float dinominator[192];
  __nram__ float dinominator_temp[192];
  __nram__ float src1[192];
  __nram__ float addition[192];

  for(int i = clusterId * 4 + coreId; i < 1; i+=16){
    __memcpy(src1, A + i * 192, 192 * sizeof(float), GDRAM2NRAM);
    __bang_active_exp(src1, src1, 192);
    __bang_write_zero(dinominator, 192);
    __bang_sumpool(dinominator, src1, 1, 1, 192, 1, 192, 1, 1);
    __memset_nram(dinominator_temp, 192, dinominator[0]);
    __bang_div(dest, src1, dinominator_temp, addition, 192);
    __memcpy(output + 192 * i, dest, 192 * sizeof(float), NRAM2GDRAM);
  }
}