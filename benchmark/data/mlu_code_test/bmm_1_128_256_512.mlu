 extern "C" __mlu_global__ void bmm(int8 *data, int8 *filter, float *output) {
  __nram__ int8 date_block[512];
  __wram__ int8 filter_block[16384];
  for (int i = 0; i < 64; ++i) {
    for (int j = 0; j < 2; ++j) {
      __memcpy(((int8 *)date_block + (0)), ((int8 *)data + (((i * 512) + (j * 256)))), 256, GDRAM2NRAM);
      for (int k = 0; k < 8; ++k) {
        __memcpy(((int8 *)filter_block + (0)), ((int8 *)filter + ((k * 64))), 64, GDRAM2WRAM, 64, 512, 255);
        __bang_mlp(((float *)date_block + (64)), ((int8 *)date_block + (0)), ((int8 *)filter_block + (0)), 256, 64, 0);
        __memcpy(((float *)output + ((((i * 1024) + (j * 512)) + (k * 64)))), ((float *)date_block + (64)), 256, NRAM2GDRAM);
      }
    }
  }
}
