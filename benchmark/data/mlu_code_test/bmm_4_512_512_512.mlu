extern "C" __mlu_global__ void bmm(float *data, float *filter, float *output) {
  __nram__ float date_block[640];
  __wram__ float filter_block[32768];
    for (int j = 0; j < 128; ++j) {
      __memcpy(((float *)date_block + (0)), ((float *)data + ((((clusterId * 4 + coreId) * 65536) + (j * 512)))), 2048, GDRAM2NRAM);
      for (int k = 0; k < 8; ++k) {
        __memcpy(((float *)filter_block + (0)), ((float *)filter + (clusterId * 4 + coreId) * 65536 + ((k * 64))), 256, GDRAM2WRAM, 256, 2048, 511);
        __bang_matmul(((float *)date_block + (256)), ((float *)date_block + (0)), ((float *)filter_block + (0)), 1, 512, 64);
        __memcpy(((float *)output + (((((clusterId * 4 + coreId) * 16384) + (j * 512)) + (k * 64)))), ((float *)date_block + (256)), 256, NRAM2GDRAM);
      }
    }
}
