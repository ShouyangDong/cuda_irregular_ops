extern "C" __mlu_global__ void bmm(float *A, float *B, float *C) {
  __nram__ float A_nram[128 * 512];
  __wram__ float B_wram[512 * 512];
  __nram__ float C_nram[128 * 512];
  if (clusterId < 4) {
    if (coreId < 4) {
      __memcpy(A_nram, A + (clusterId * 4 + coreId) * 128 * 512, 128 * 512 * 4,
               GDRAM2NRAM);
      __memcpy(B_wram, B + (clusterId * 4 + coreId) * 512 * 512, 512 * 512 * 4,
               GDRAM2WRAM);
      __bang_mlp(C_nram, A_nram, B_wram, 128, 512);
      __memcpy(C + (clusterId * 4 + coreId) * 128 * 512, C_nram, 128 * 512 * 4,
               NRAM2GDRAM);
    }
  }
}
